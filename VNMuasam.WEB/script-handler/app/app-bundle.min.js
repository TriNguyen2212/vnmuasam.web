var UtilJS={},MasterPageController,formatMoney,getWidth,lazyLoad,noInput,whenEnter,compile,gridSort,paginationStyle1,inputFormat,$localstorage,CommonFactory,UtilFactory,HelperFactory,dateFormat,trustHtml,ifEmpty,toFixedDecimal,lstDependency,MyApp,addFactory,addController,addDirective,addFilter;UtilJS.DateTime={};UtilJS.DateTime.ToString=function(n,t){var f,i;if(!n)return"underfine";var r=new Date(parseInt(n.replace(/(^.*\()|([+-].*$)/g,""))),e=r.getDate(),u=e.toString();return(e<=9&&(u="0"+u),f=r.getMonth()+1,i=f.toString(),f<=9&&(i="0"+i),t=="dd/mm/yyyy")?u+"/"+i+"/"+r.getFullYear():u+"-"+i+"-"+r.getFullYear()};UtilJS.String={};UtilJS.String.IsNullOrEmpty=function(n){return!n||n==null?!0:!1};UtilJS.String.RemoveUnicode=function(n){return n=n.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),n=n.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),n=n.replace(/ì|í|ị|ỉ|ĩ/g,"i"),n=n.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),n=n.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),n=n.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),n.replace(/đ/g,"d")};UtilJS.String.IsContain=function(n,t,i){return UtilJS.String.IsNullOrEmpty(n)?!1:UtilJS.String.IsNullOrEmpty(t)?!0:(n=n.normalize(),t=t.normalize(),n=n.toLowerCase(),t=t.toLowerCase(),i&&(n=UtilJS.String.RemoveUnicode(n),t=UtilJS.String.RemoveUnicode(t)),n.indexOf(t)<0)?!1:!0};UtilJS.String.IsContainUnsigned=function(n){return UtilJS.String.IsNullOrEmpty(n)?!1:(n=n.normalize(),n=n.toLowerCase(),n=UtilJS.String.RemoveUnicode(n),/^[a-zA-Z0-9- ]*$/.test(n)==!1)?!0:!1};UtilJS.Tree={};UtilJS.Tree.CheckParentIDNotExists=function(n){n.forEach(function(t){var i=!1;t.parent!="#"&&(n.forEach(function(n){t.parent==n.id&&(i=!0)}),!i)})};UtilJS.isNumber=function(n){var t=n.which?n.which:n.keyCode;return t!=46&&t>31&&(t<48||t>57)?!1:!0};UtilJS.SumDecimal=function(n){return Math.round(n*1e12)/1e12};UtilJS.Array={};UtilJS.Array.Sort=function(n,t){return _.sortBy(n,function(n){try{let i=n[t].normalize();return i=i.toLowerCase(),UtilJS.String.RemoveUnicode(i)}catch(i){throw i;}})};MasterPageController=function(n,t,i,r,u,f,e){t.MasterPage={IsLoading:!1};t.UserPricinpal={};MasterData.IsResetUserPricinpal&&(e.remove("UserPricinpal"),MasterData.objUserPrincipal.LstPermission=MasterData.LstPermission,MasterData.objUserPrincipal.AccessToken=MasterData.objUserPrincipal.AccesToken,e.setObject("UserPricinpal",MasterData.objUserPrincipal));t.MasterPage.RemoveCache=function(){i(function(){u.PostDataAjax("/OutputCaches/Remove",{},function(){},function(n){i(function(){if(n.objCodeStep.Status=="Error"){jAlert.Error(n.objCodeStep.Message);return}if(n.objCodeStep.Status=="Success"){jAlert.Success("xóa cache thành công");return}},100)},function(){return})})};t.UserPricinpal.IsInRole=function(n){let t=e.getObject("UserPricinpal"),i=_.filter(t.LstPermission,function(i){return _.contains(t.RoleIDs,i.RoleID)&&n==i.RoleFunctionName?!0:!1});return i.length==0?!1:!0}};MasterPageController.$inject=["$scope","$rootScope","$timeout","$filter","CommonFactory","UtilFactory","$localstorage"];formatMoney=function(n,t){return{require:"?ngModel",restrict:"A",scope:{myModel:"=",precision:"=",formatMoneyNoInput:"="},link:function(n,i){(n.precision==null||n.precision==undefined)&&(n.precision=0);i.maskMoney({allowNegative:!0,thousands:",",decimal:".",affixesStay:!1,allowZero:!0,precision:n.precision});i.keydown(function(r){var u=String.fromCharCode(r.which);if(_.contains(n.formatMoneyNoInput,u)){r.preventDefault();return}t(function(){n.myModel=parseFloat(i.val().replace(new RegExp(",","g"),""));i.trigger("change")})});n.$watch("myModel",function(){$.isNumeric(n.myModel)&&n.myModel.toString().indexOf(".")>0?i.val(n.myModel.toFixed(n.precision)).trigger("mask.maskMoney"):i.val(n.myModel).trigger("mask.maskMoney")})}}};formatMoney.$inject=["$filter","$timeout"];getWidth=function(n,t){return{restrict:"A",scope:{getWidth:"="},link:function(n,i){$(function(){n.getWidth=i[0].offsetWidth;t(function(){n.getWidth=i[0].offsetWidth},500)})}}};getWidth.$inject=["$timeout","$interval"];lazyLoad=function(n,t){return{restrict:"A",scope:{fncallback:"&lazyLoad"},link:function(n,i){n.IsLoaded=!1;n.raw=i[0];angular.element(t).bind("scroll",function(){var i=$(n.raw).is(":visible"),t;!n.IsLoaded&&i&&(t=$(n.raw).position().top,this.pageYOffset+this.innerHeight>=t&&(n.fncallback(),n.IsLoaded=!0,n.$apply()))})}}};lazyLoad.$inject=["$timeout","$window"];noInput=function(){return{restrict:"A",scope:{noInput:"="},link:function(n,t){t.bind("keydown keypress",function(t){var i=String.fromCharCode(t.which);_.contains(n.noInput,i)&&t.preventDefault()})}}};noInput.$inject=[];whenEnter=function(){return function(n,t,i){t.bind("keydown keypress",function(t){t.which===13&&(n.$apply(function(){n.$eval(i.whenEnter)}),t.preventDefault())})}};whenEnter.$inject=[];compile=function(n){return function(t,i,r){t.$watch(function(n){return n.$eval(r.compile)},function(r){i.html(r);n(i.contents())(t)})}};compile.$inject=["$compile"];gridSort=function(){return{restrict:"E",scope:{sort:"=",columnName:"=",fnCallBack:"&"},templateUrl:"/script-handler/app/directives/GridSort/GridSort.html",link:function(){}}};gridSort.$inject=["$timeout"];paginationStyle1=function(n){return{restrict:"E",scope:{pager:"=",totalItems:"=",fnCallBack:"&"},templateUrl:"/script-handler/app/directives/pagination-style/pagination-style.html",link:function(t){function i(){if(!t.pager.CurrentPage||t.pager.CurrentPage<1||t.pager.CurrentPage>t.pager.TotalPages){t.pager.Pages=[];return}if(!t.pager.TotalPages){t.pager.Pages=[];return}r(t.pager.TotalItems,t.pager.CurrentPage,t.pager.PageSize)}function r(n,i,r){var o,e,c,v,l,u;i=i||1;r=r||10;o=t.pager.StartPage||1;e=t.pager.EndPage||10;var s=10,f=[],h=Math.floor(t.pager.TotalPages/s),a=t.pager.TotalPages%s;for(u=1;u<=h;u++)c=(u-1)*r,v=c+s,f.push({Start:c+1,End:v});for(a>0&&f.push({Start:h*s+1,End:h*s+a}),l=!1,u=0;u<f.length;u++)if(i>=f[u].Start&&i<=f[u].End){o=f[u].Start;e=f[u].End;e>10&&e-o<9&&(o=e-9);l=!0;break}l||(i=f[0].Start,o=f[0].Start,e=f[0].End);var y=(i-1)*r,w=Math.min(y+r-1,n-1),p=[];for(u=o;u<=e;u++)p.push(u);i<=0&&(i=1);t.pager.PageSize=r;t.pager.StartPage=o;t.pager.EndPage=e;t.pager.StartIndex=y;t.pager.EndIndex=w;t.pager.Pages=p}t.pager.TotalItems=0;t.pager.TotalPages=0;t.$watch("totalItems",function(){t.pager.TotalItems=t.totalItems;t.InitPager()});t.$watch("pager.CurrentPage",function(){t.InitPager()});t.InitPager=function(){n(function(){t.pager.TotalPages=Math.ceil(t.pager.TotalItems/t.pager.PageSize);t.pager.CurrentPage>t.pager.TotalPages&&(t.pager.CurrentPage=t.pager.TotalPages,t.pager.TotalPages==0&&(t.pager.CurrentPage=1));i()})};t.Exec=function(n){n>t.pager.TotalPages||t.fnCallBack({PageClicked:n})};t.ExecFirst=function(n){n>t.pager.TotalPages&&(n=t.pager.TotalPages);n<=0&&(n=1);t.pager.StartPage=t.pager.StartPage-10;t.pager.EndPage=t.pager.EndPage-10;t.pager.StartPage<=0&&(t.pager.StartPage=1,t.pager.EndPage=10);t.fnCallBack({PageClicked:n})};t.ExecLast=function(n){n>t.pager.TotalPages&&(n=t.pager.TotalPages);t.pager.StartPage=t.pager.EndPage+1;t.pager.EndPage=t.pager.StartPage+9;t.pager.EndPage>t.pager.TotalPages&&(t.pager.EndPage=t.pager.TotalPages,t.pager.StartPage=t.pager.EndPage-9);t.fnCallBack({PageClicked:n})}}}};paginationStyle1.$inject=["$timeout"];inputFormat=function(n){return{require:"?ngModel",restrict:"A",link:function(t,i,r,u){(t.defaultValue=r.defaultValue?r.defaultValue:!1,u)&&(i.bind("keypress",function(n){var i=this.getAttribute("allow-decimal")=="true"?!0:!1,t=n.which||n.keyCode;if(t>47&&t<58||t==8||t==9||t==190||t==39||t==37||t==43||i&&t==46)return!0;n.preventDefault()}),u.$formatters.unshift(function(){return n(r.inputFormat)(u.$modelValue?u.$modelValue:0)}),u.$parsers.unshift(function(u){var f,e,o,s;if(t.defaultValue&&!parseInt(u)&&(u=t.defaultValue),f=u.replace(/[^\d|\.|\-]/g,""),f=f||0,f!="")return e=f.match(/\./g),o=f.match(/\.$/g),e=e!=null&&e.length==1&&o!=null?".":"",s=n(r.inputFormat)(f),i.val(s+e).trigger("change"),parseFloat(f)}))}}};inputFormat.$inject=["$filter"];$localstorage=function(n){return{set:function(t,i){n.localStorage[t]=i},get:function(t,i){return n.localStorage[t]||i},setObject:function(t,i){n.localStorage[t]=JSON.stringify(i)},getObject:function(t){try{var i=n.localStorage[t];if(i)return JSON.parse(i||"{}")}catch(r){return JSON.parse("{}")}},remove:function(t){n.localStorage.removeItem(t)},clearAll:function(){n.localStorage.clear()}}};$localstorage.$inject=["$window"];$localstorage=function(n){return{set:function(t,i){n.localStorage[t]=i},get:function(t,i){return n.localStorage[t]||i},setObject:function(t,i){n.localStorage[t]=JSON.stringify(i)},getObject:function(t){try{var i=n.localStorage[t];if(i)return JSON.parse(i||"{}")}catch(r){return JSON.parse("{}")}},remove:function(t){n.localStorage.removeItem(t)},clearAll:function(){n.localStorage.clear()}}};$localstorage.$inject=["$window"];CommonFactory=function(n,t,i,r,u,f){var e={};return e.PostDataAjax=function(n,t,u,f,e,o){try{o||(o=6e4);$.ajax({url:n,type:"POST",dataType:"json",data:t,beforeSend:u,success:function(n){i(function(){f(n)})},error:function(n){r.Alert.RequestError(n);i(function(){e(n)})},complete:function(){}}).always(function(){})}catch(s){console.log("CommonFactory.PostDataAjax() error :"+s)}},e.GetDataAjax=function(n,t,u,f,e,o){try{o||(o=6e4);$.ajax({url:n,type:"GET",dataType:"json",data:t,beforeSend:u,success:function(n){i(function(){f(n)})},error:function(n){r.Alert.RequestError(n);i(function(){e(n)})},complete:function(){}}).always(function(){})}catch(s){console.log("CommonFactory.PostDataAjax() error :"+s)}},e.PostDataAjaxAsync=function(n,t,i,u,f,e){try{e||(e=6e4);$.ajax({url:n,type:"POST",dataType:"json",data:t,beforeSend:i,async:!1,success:function(n){u(n)},error:function(n){r.Alert.RequestError(n);f(n)},complete:function(){}}).always(function(){})}catch(o){console.log("CommonFactory.PostDataAjaxAsync() error :"+o)}},e.PostPromise=function(n,t,i,r){var e=u.defer();return f({method:"POST",url:n,data:t}).then(function(n){i&&i(n);e.resolve(n)},function(n){r&&r(n);e.reject(n)}),e.promise},e};CommonFactory.$inject=["$rootScope","$localstorage","$timeout","UtilFactory","$q","$http"];UtilFactory=function(){var n={};return n.InitArrayNoIndex=function(n){for(var i=[],t=1;t<n;t++)i.push(t);return i},n.String={},n.String.IsNullOrEmpty=function(n){return!n||n==null?!0:!1},n.String.IsContain=function(t,i){return n.String.IsNullOrEmpty(t)?!1:n.String.IsNullOrEmpty(i)?!0:t.indexOf(i)<0?!1:!0},n.Alert={},n.Alert.RequestError=function(n){console.log(n);var t="";switch(n.status){case 400:t="Lỗi dữ liệu không hợp lệ";break;case 401:t="Phiên làm việc đã hết hạn, vui lòng đăng nhập lại.";break;case 403:t="Bạn không có quyền thực hiện thao tác này.";break;case 404:t="URL action không chính xác";break;case 405:t="phương thức không được chấp nhận";break;case 500:t="lỗi hệ thống";break;case 502:t="đường truyền kém";break;case 503:t="dịch vụ không hợp lệ";break;case 504:t="hết thời gian chờ";break;default:t="Lỗi chưa xác định"}jAlert.Error(t,"Thông báo")},n};UtilFactory.$inject=["$rootScope","$timeout"];HelperFactory=function(n,t,i){var r={};return r.User={},r.User.GetAccessToken=function(){return r.User.AccessToken||(n.MasterPage.IsLoading=!0,i.PostDataAjaxAsync("/Home/GetAccesToken",null,function(){},function(t){if(n.MasterPage.IsLoading=!1,t.objCodeStep.Status=="Error"){console.log(t);throw t.objCodeStep.Message;}t.objCodeStep.Status=="Success"&&(r.User.AccessToken=t.strAccesToken)},function(t){n.MasterPage.IsLoading=!1;console.log(t);throw"error";})),r.User.AccessToken},r};HelperFactory.$inject=["$rootScope","$timeout","CommonFactory"];dateFormat=function(n){return function(t,i){var u,f,r;return t?((i==undefined||i=="")&&(i="dd/MM/yyyy"),t instanceof Date?r=t:(u=t.replace(/\//g,"").replace("(","").replace(")","").replace("Date","").replace("+0700","").replace("-0000",""),r=t.indexOf("Date")>-1?new Date(+u):new Date(u),f=r.getTime()+r.getTimezoneOffset()*6e4,r=new Date(f+252e5)),n("date")(r,i)):""}};dateFormat.$inject=["$filter"];trustHtml=function(n){return function(t){return t?n.trustAsHtml(t):""}};trustHtml.$inject=["$sce"];ifEmpty=function(){return function(n,t){return angular.isUndefined(n)||n===null||n===""||n==="Invalid date"?t:n}};toFixedDecimal=function(n){try{return function(t,i){var r,u;if(!t)return 0;if(r=t.toString().split(".")[1],r){if(i==undefined||i=="")i=r.length;else{for(r=r.toString().slice(0,i),u=r.length;u>0;u--)if(r.charAt(u-1)!=0)break;else r=r.substring(0,r.length-1);i=r.length}t=n("number")(parseFloat(t),i)}else t=n("number")(t);return t}}catch(t){return 0}};toFixedDecimal.$inject=["$filter"];lstDependency=[];lstDependency.push("ngRoute");lstDependency.push("angular.filter");MyApp=angular.module("MyApp",lstDependency);addFactory=function(n,t){try{MyApp.factory(n,t)}catch(i){console.log(JSON.stringify(i))}};addFactory("$localstorage",$localstorage);addFactory("CommonFactory",CommonFactory);addFactory("UtilFactory",UtilFactory);addFactory("HelperFactory",HelperFactory);addController=function(n,t){try{MyApp.controller(n,t)}catch(i){console.log(JSON.stringify(i))}};addController("MasterPageController",MasterPageController);addDirective=function(n,t){try{MyApp.directive(n,t)}catch(i){console.log(JSON.stringify(i))}};addDirective("formatMoney",formatMoney);addDirective("getWidth",getWidth);addDirective("lazyLoad",lazyLoad);addDirective("noInput",noInput);addDirective("whenEnter",whenEnter);addDirective("compile",compile);addDirective("gridSort",gridSort);addDirective("inputFormat",inputFormat);addDirective("paginationStyle1",paginationStyle1);addFilter=function(n,t){try{MyApp.filter(n,t)}catch(i){console.log(JSON.stringify(i))}};addFilter("dateFormat",dateFormat);addFilter("trustHtml",trustHtml);addFilter("ifEmpty",ifEmpty);addFilter("toFixedDecimal",toFixedDecimal);MyAppSetConfig={};MyAppSetConfig.addURL=function(n,t,i,r){try{r.when("/"+n,{templateUrl:"/"+t,controller:i})}catch(u){console.log(u)}};MyAppSetConfig.Otherwise=function(n,t){t.otherwise({redirectTo:"/"+n})};